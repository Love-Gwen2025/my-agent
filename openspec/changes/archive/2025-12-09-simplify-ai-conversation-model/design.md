# 设计说明

## 范围
- 目标：将聊天模型限定为“单用户 ↔ AI 助手”的对话，取消人与人/群聊能力。
- 影响面：会话/消息实体、数据库 schema（会话类型/成员表）、Service 层校验与查询逻辑、相关枚举/常量。

## 主要设计决策
1. 会话归属
   - 会话仅绑定一个用户（owner），不再维护成员集合。
   - `Conversation.type` 若保留，固定为 AI 对话；如无兼容性需求可移除该字段与相关枚举/常量（避免业务分支）。
2. 成员关系
   - `ConversationMember` 表/实体仅用于多成员，按本变更删除；权限校验改为“owner == 当前用户”，无成员列表。
3. 消息角色
   - `Message.senderId` 仅允许“owner”与“助手(-1 或 null 明确标识)”两类，`role` 限定为 `user`/`assistant`。
4. 兼容性
   - 若存在历史多成员数据，提供迁移策略（如仅保留会话创建者，或按最早/最新成员归属）；如无历史数据，可直接移除表字段。
5. 受影响接口
   - 会话创建/查询、消息发送、聊天接口的校验分支需要与简化后的模型一致（不再检查成员列表/类型枚举）。
6. 审计基类
   - 所有领域实体继承 BasePo，以统一 ID/创建时间/更新时间/版本等审计字段；若有未继承的实体需调整并同步表结构和 Mapper。
