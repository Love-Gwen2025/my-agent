## 1. 后端
- [x] 设计并实现编辑历史消息的接口：接收 conversationId、targetMessageId、checkpointId、新内容；基于 checkpoint 分叉生成新分支，返回新 AI 回复与新 checkpointId，保留旧分支。
- [x] 为当前 AI 回复提供重新生成接口/参数：基于目标 checkpoint 创建兄弟分支生成新回复，返回新 checkpointId，旧回复可通过 siblings 导航。
- [x] SSE `done`/同步返回中携带最新 checkpointId，确保前端可以续写；补充必要的权限校验与错误处理。

## 2. 前端
- [x] store 增加/复用当前 checkpointId；编辑/重新生成/发送时携带；切换分支后更新并刷新消息列表。
- [x] 聊天 UI：
  - 任意历史用户消息支持“编辑”入口，提交后用返回的消息列表/分支更新视图。
  - 当前 AI 回复展示“重新生成”按钮，生成兄弟分支并更新 `<x/y>` 导航。
- [x] SSE 完成事件读取 checkpointId，持久化到状态；切换/生成期间禁用分支导航避免竞态。

## 3. 验证
- [ ] 手动验证：编辑历史消息生成新分支且旧分支可切换；当前 AI 回复重新生成得到新分支；后续提问沿当前分支继续。
- [ ] 如有余力，补充最小化自动化验证或记录详细手测步骤。
